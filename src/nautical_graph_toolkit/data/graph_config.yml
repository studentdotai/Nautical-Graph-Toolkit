 # ===============================================
  # Maritime Graph Generation Configuration
  # ===============================================

  # --- General Settings ---
  graph_type: "h3"  # "h3" or "fine"
  output_gpkg: "graphs/h3_graph.gpkg"
  keep_largest_component: true

  # --- Unified Layer Configuration ---
  # All layers use the same format: { layer: "name", bands: [1,2,3] or "all", resolution: N }
  # - "resolution" is ONLY used by H3Graph
  # - FineGraph uses seaare bands [1-6] for progressive refinement (hardcoded)
  # - Both graphs use the same format for extra layers and subtract layers

  layers:
    # Base navigable layers (additive - form the graph)
    navigable:
      # seaare is processed specially by both graphs
      # FineGraph: progressive refinement by bands 1-6
      # H3Graph: resolution mapping by bands
      - { layer: "seaare", bands: [1, 2], resolution: 6 }
      - { layer: "seaare", bands: [3],    resolution: 9 }
      - { layer: "seaare", bands: [4],    resolution: 10 }
      - { layer: "seaare", bands: [5],    resolution: 11 }
      - { layer: "seaare", bands: [6],    resolution: 12 }

      # Additional navigable layers (both graphs use same logic)
      - { layer: "drgare", bands: [3, 4, 5, 6], resolution: 11 }
      - { layer: "fairwy", bands: "all", resolution: 11 }
      - { layer: "tsslpt", bands: "all", resolution: 11 }
      - { layer: "prcare", bands: "all", resolution: 10 }

    # Obstacle/restriction layers (subtractive)
    obstacles:
      # lndare is processed specially by FineGraph (per-band subtraction)
      # H3Graph processes it like other subtract layers
      - { layer: "lndare", bands: [1, 2, 3, 4, 5, 6], resolution: null }
      - { layer: "slcons", bands: [1, 2, 3, 4, 5, 6], resolution: null }
      # Commented examples:
      # - { layer: "obstrn", bands: [3, 4, 5, 6], resolution: null }
      # - { layer: "wrecks", bands: "all", resolution: null }

  # --- Fine Graph Specific Settings ---
  fine_settings:
    spacing_nm: 0.1
    max_edge_factor: 2.0
    max_points_per_subdivision: 1000000
    # usage_bands: [1,2,3,4,5,6]  # Can override default seaare bands if needed

  # --- H3 Graph Specific Settings ---
  h3_settings:
    connectivity:
      enable_hierarchical: true
      enable_spatial_proximity: true
      max_spatial_distance_nm: 2.7
      spatial_search_radius: 2
      enable_bridge_enhancement: true
      min_same_resolution_connections: 4
      target_total_connections: 6
      max_bridge_distance_nm: 4.3
      bridge_search_radius: 3

  # --- Weighting Configuration ---
  # Weight values are retrieved from S57Classifier
  # Users can customize by editing CSV: S57Classifier.generate_static_files()
  weight_settings:
    # Path to custom S57 classification CSV (null = use built-in defaults)
    classifier_csv_path: null

    # Default vessel parameters for dynamic weight calculations
    default_vessel:
      draft: 7.5              # meters - vessel draft (depth below waterline)
      height: 30.0            # meters - air draft (height above waterline)
      beam: 25.0              # meters - vessel width
      length: 150.0           # meters - vessel length
      vessel_type: 'cargo'    # cargo, tanker, passenger, fishing
      safety_margin: 2.0      # meters - UKC safety buffer (Under Keel Clearance)
      clearance_safety: 3.0   # meters - vertical clearance buffer (bridges)

    # Static layers: weight factors retrieved from S57Classifier during graph construction
    # List only the layer names - actual weight values come from the classifier
    # Three-tier system: SAFE (bonus), CAUTION (penalty), DANGEROUS (blocking)
    # Distance-based degradation: features degrade one tier when within buffer distance
    static_layers:
      - lndare      # Land area (DANGEROUS - absolute blocker)
      - obstrn      # Obstruction (DANGEROUS - high penalty)
      - uwtroc      # Underwater rock (DANGEROUS - high penalty)
      - wrecks      # Wrecks (DANGEROUS - high penalty)
      - slcons      # Shoreline construction (DANGEROUS - blocker)
      - coalne      # Coastline (DANGEROUS - blocker)
      - fairwy      # Fairway (SAFE - preferred route)
      - tsslpt      # Traffic separation lane (CAUTION - moderate penalty)
      - drgare      # Dredged area (SAFE - slight preference)
      - prcare      # Precautionary area (CAUTION - moderate penalty)
      - resare      # Restricted area (CAUTION - moderate penalty)
      - cblare      # Cable area (CAUTION - moderate penalty)
      - pipare      # Pipeline area (CAUTION - moderate penalty)
      - rectrc      # Recommended track (SAFE - preferred route)
      - dwrtcl      # Deep water route centerline (SAFE - preferred route)

    # Directional weights: traffic flow alignment (orientation-based penalties/rewards)
    # Applied to layers with ORIENT attribute (tsslpt, dwrtcl, rectrc, fairwy, etc.)
    directional_weights:
      enabled: true

      # Layers to apply directional weights (null = all layers with ORIENT attribute)
      apply_to_layers: null  # Or specify: ['tsslpt', 'dwrtcl', 'rectrc', 'fairwy']

      # Angle-based weight bands (angular difference between edge and feature orientation)
      angle_bands:
        - { max_angle: 30, weight: 0.9, description: 'Aligned - following intended direction' }
        - { max_angle: 60, weight: 1.3, description: 'Slight deviation' }
        - { max_angle: 85, weight: 5.0, description: 'Significant deviation' }
        - { max_angle: 95, weight: 20.0, description: 'Crossing/perpendicular' }
        - { max_angle: 180, weight: 99.0, description: 'Opposite - against traffic flow' }

      # Two-way traffic handling (for TRAFIC=4 features)
      two_way_traffic:
        enabled: true
        reverse_check_threshold: 95.0  # degrees - check reverse orientation if diff > threshold

    # Dynamic properties: computed at pathfinding runtime via spatial queries
    # These query actual feature attributes for real-time decision making
    dynamic_properties:
      depth_min:
        layer: 'depare'
        attribute: 'drval1'
        query_type: 'min'
      wreck_sounding:
        layer: 'wrecks'
        attribute: 'valsou'
        query_type: 'min'

    # Land crossing protection: additional penalties for pathfinding operations
    land_crossing_protection:
      enabled: true
      penalties:
        minor_crossing: 10
        moderate_crossing: 100
        major_crossing: 1000
        blocked: 9999